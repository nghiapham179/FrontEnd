<!-- POSTER COVER (tr√°nh *ngIf ƒë·ªÉ kh√¥ng k·∫πt animation) -->
<section
  class="poster-cover"
  role="dialog"
  aria-modal="true"
  [attr.aria-hidden]="!showCover ? 'true' : 'false'"
  [class.hide]="!showCover"
  [class.force-off]="forceOff"
  (animationend)="onCoverAnimEnd($event)"
>
  <img class="poster-media" src="assets/Phone/IPhone.jpg" alt="TechNoX poster" width="1200" height="800" decoding="async" fetchpriority="high" />
  <h1 class="poster-title">TECHNO<span>X</span></h1>
</section>

<!-- HEADER -->
<header class="site-header">
  <div class="container header-inner">
    <!-- N√∫t menu -->
    <button class="icon-btn" type="button" (click)="toggleMenu()" aria-label="M·ªü menu" aria-controls="mobileMenu" [attr.aria-expanded]="mobileMenuOpen ? 'true' : 'false'">‚ò∞</button>

    <!-- LOGO -->
    <a class="brand" routerLink="/" aria-label="Trang ch·ªß TechNoX">
      <img class="brand__logo" src="assets/Phone/Logo.png" alt="TechNoX" width="200" height="40" decoding="async" fetchpriority="high" />
      <span class="brand__name">TechNoX</span>
    </a>

    <div class="header-actions">
      <!-- ƒê√É ƒêƒÇNG NH·∫¨P -->
      <ng-container *ngIf="auth.user(); else guestActions">
        <span class="welcome">Xin ch√†o, <strong>{{ auth.user()?.name }}</strong></span>
        <button class="btn btn--outline" type="button" (click)="logout()">ƒêƒÉng xu·∫•t</button>
        <a class="cart" routerLink="/cart" aria-label="Gi·ªè h√†ng">Gi·ªè h√†ng (0)</a>
      </ng-container>

      <!-- CH∆ØA ƒêƒÇNG NH·∫¨P -->
      <ng-template #guestActions>
        <a class="link-auth" routerLink="/login">ƒêƒÉng nh·∫≠p</a>
        <a class="btn btn--accent btn-auth" routerLink="/register">ƒêƒÉng k√Ω</a>
        <a class="cart" routerLink="/cart" aria-label="Gi·ªè h√†ng">Gi·ªè h√†ng (0)</a>
      </ng-template>
    </div>
  </div>
</header>

<!-- MOBILE MENU -->
<nav class="mobile-menu" id="mobileMenu" [class.open]="mobileMenuOpen" (click)="closeMenu()" aria-label="Menu di ƒë·ªông">
  <div class="mobile-menu__panel" (click)="$event.stopPropagation()">
    <button class="mobile-menu__close" type="button" (click)="closeMenu()" aria-label="ƒê√≥ng menu">‚úï</button>
    <ul>
      <li><a routerLink="/shop" (click)="closeMenu()">ƒêi·ªán tho·∫°i</a></li>
      <li><a routerLink="/accessories" (click)="closeMenu()">Ph·ª• ki·ªán</a></li>
      <li><a routerLink="/laptop" (click)="closeMenu()">Laptop</a></li>
      <li><a routerLink="/privacy" (click)="closeMenu()">Ch√≠nh S√°ch</a></li>

      <li class="divider" role="separator" aria-hidden="true"></li>

      <!-- ƒê√É ƒêƒÇNG NH·∫¨P -->
      <ng-container *ngIf="auth.user(); else mobileGuest">
        <li class="muted">Xin ch√†o, <strong>{{ auth.user()?.name }}</strong></li>
        <li><button class="link-like" type="button" (click)="logout(); closeMenu()">ƒêƒÉng xu·∫•t</button></li>
      </ng-container>

      <!-- CH∆ØA ƒêƒÇNG NH·∫¨P -->
      <ng-template #mobileGuest>
        <li><a routerLink="/login" (click)="closeMenu()">ƒêƒÉng nh·∫≠p</a></li>
        <li><a routerLink="/register" (click)="closeMenu()">ƒêƒÉng k√Ω</a></li>
      </ng-template>
    </ul>
  </div>
</nav>

<main>
  <!-- HERO -->
  <section class="hero section-pad">
    <div class="container hero__inner">
      <p class="eyebrow">Ch√∫ng t√¥i l√† TechNoX</p>
      <h1 class="hero__title">SMARTPHONES<br /> FOR EVERYONE</h1>
      <p class="hero__desc">
        B√°n l·∫ª ƒëi·ªán tho·∫°i ch√≠nh h√£ng. B·∫£o h√†nh 12‚Äì24 th√°ng. Tr·∫£ g√≥p 0%,
        giao nhanh trong ng√†y, ƒë·ªïi tr·∫£ d·ªÖ d√†ng.
      </p>
      <a class="btn btn--accent" href="#" aria-label="Mua ngay">MUA NGAY</a>

      <div class="hero__gallery">
        <img src="assets/Phone/IPhone.jpg" alt="Flagship phone" width="1200" height="800" loading="eager" decoding="async" />
        <img src="assets/Phone/Iphone1.jpg" alt="Flagship phone" width="1200" height="800" loading="lazy" decoding="async" />
      </div>
    </div>
  </section>

  <!-- S·∫¢N PH·∫®M N·ªîI B·∫¨T -->
  <section class="selected section-pad">
    <div class="container selected__inner">
      <p class="eyebrow eyebrow--gold">D√≤ng s·∫£n ph·∫©m n·ªïi b·∫≠t</p>
      <h2 class="section-title">ƒêI·ªÜN THO·∫†I<br />ƒê∆Ø·ª¢C CH·ªåN L·ªåC</h2>

      <div #heroGrid class="card-grid">
        <article class="card" *ngFor="let p of heroPaged; trackBy: trackById">
          <a class="card__media" [style.background-image]="'url(' + p.image + ')'" [attr.aria-label]="p.name" href="#"></a>
          <div class="card__body">
            <h3 class="card__title">{{ p.name }}</h3>
            <div class="chip-row" *ngIf="p.tags?.length">
              <span class="chip" *ngFor="let t of p.tags">{{ t }}</span>
            </div>
            <p class="price">T·ª´ {{ p.price | number:'1.0-0' }}ƒë</p>
            <button class="btn btn--block" type="button" (click)="add(p)">TH√äM V√ÄO GI·ªé</button>
          </div>
        </article>
      </div>

      <!-- PAGER + N√öT XEM TO√ÄN B·ªò (√©p login) -->
      <div class="section-cta">
        <nav class="pager" role="navigation" aria-label="Ph√¢n trang s·∫£n ph·∫©m n·ªïi b·∫≠t">
          <button class="pager__btn" type="button" (click)="heroPrev()" [disabled]="heroPage === 1" [attr.aria-disabled]="heroPage === 1">‚Üê</button>
          <span class="pager__info">Trang {{ heroPage }} / {{ heroTotalPages }}</span>
          <button class="pager__btn" type="button" (click)="heroNext()" [disabled]="heroPage === heroTotalPages" [attr.aria-disabled]="heroPage === heroTotalPages">‚Üí</button>
        </nav>

        <button
          class="btn btn--black view-all"
          type="button"
          (click)="goToProducts()"
          [attr.aria-disabled]="!auth.user() ? 'true' : null"
          [class.btn-disabled]="!auth.user()"
          [title]="auth.user() ? '' : 'Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ xem to√†n b·ªô s·∫£n ph·∫©m'"
        >
          XEM TO√ÄN B·ªò S·∫¢N PH·∫®M
        </button>
      </div>
    </div>
  </section>

  <!-- LAPTOP -->
  <section class="laptop-intro section-pad">
    <div class="container">
      <div class="split">
        <div class="split__media">
          <video #heroVideo class="hero-video" autoplay muted loop playsinline preload="auto" (error)="onVideoError($event)" (canplay)="onVideoCanPlay()">
            <source src="assets/Video/MacPro.mp4" type="video/mp4" />
            Tr√¨nh duy·ªát c·ªßa b·∫°n kh√¥ng h·ªó tr·ª£ video.
          </video>
          <button class="mute-btn" type="button" (click)="toggleMute(heroVideo)" aria-label="B·∫≠t/t·∫Øt √¢m thanh video">{{ isMuted ? 'üîá' : 'üîä' }}</button>
        </div>

        <div class="split__content">
          <p class="eyebrow">Laptop m·ªõi nh·∫•t</p>
          <h2 class="section-title">KH√ÅM PH√Å C√ÅC D√íNG<br/>LAPTOP HI·ªÜN ƒê·∫†I</h2>
          <p class="muted">
            TechNoX mang ƒë·∫øn cho b·∫°n c√°c m·∫´u laptop hi·ªáu nƒÉng cao, thi·∫øt k·∫ø sang tr·ªçng,
            ph√π h·ª£p cho h·ªçc t·∫≠p, l√†m vi·ªác v√† gi·∫£i tr√≠.
            Kh√°m ph√° ngay ƒë·ªÉ ch·ªçn cho m√¨nh chi·∫øc laptop ∆∞ng √Ω.
          </p>
          <a class="btn btn--outline" href="#">T√åM HI·ªÇU TH√äM</a>
        </div>
      </div>
    </div>
  </section>

  <!-- PH·ª§ KI·ªÜN -->
  <section class="journal section-pad accessories">
    <div class="container">
      <p class="eyebrow eyebrow--gold">S·∫£n ph·∫©m k√®m theo</p>
      <h2 class="section-title">PH·ª§ KI·ªÜN</h2>

      <div #catalogGrid class="journal-grid">
        <article class="story" *ngFor="let it of paged; trackBy: trackById">
          <a class="story__media" [style.background-image]="'url(' + it.image + ')'" href="#" [attr.aria-label]="it.name"></a>
          <h3 class="story__title">{{ it.name }}</h3>
          <p class="story__meta">{{ it.price | number:'1.0-0' }}ƒë ‚Äî {{ it.tags[0] || 'Accessory' }}</p>
        </article>
      </div>

      <!-- PAGER + N√öT XEM TH√äM (√©p login) -->
      <div class="section-cta">
        <nav class="pager" role="navigation" aria-label="Ph√¢n trang ph·ª• ki·ªán">
          <button class="pager__btn" type="button" (click)="prevPage()" [disabled]="page === 1" [attr.aria-disabled]="page === 1">‚Üê</button>
          <span class="pager__info">Trang {{ page }} / {{ totalPages }}</span>
          <button class="pager__btn" type="button" (click)="nextPage()" [disabled]="page === totalPages" [attr.aria-disabled]="page === totalPages">‚Üí</button>
        </nav>

        <button
          class="btn btn--black view-all"
          type="button"
          (click)="goToProducts()"
          [attr.aria-disabled]="!auth.user() ? 'true' : null"
          [class.btn-disabled]="!auth.user()"
          [title]="auth.user() ? '' : 'Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ xem th√™m s·∫£n ph·∫©m'"
        >
          XEM TH√äM
        </button>
      </div>
    </div>
  </section>

  <!-- NEWSLETTER -->
  <section class="newsletter">
    <div class="container newsletter__inner">
      <h3>Nh·∫≠n ∆∞u ƒë√£i &amp; voucher h√†ng tu·∫ßn</h3>
      <form class="newsletter__form" (submit)="$event.preventDefault()" aria-label="ƒêƒÉng k√Ω nh·∫≠n email khuy·∫øn m√£i">
        <input type="email" placeholder="Email c·ªßa b·∫°n" required autocomplete="email" />
        <button class="btn" type="submit">ƒêƒÇNG K√ù</button>
      </form>
      <p class="muted small">B·∫°n c√≥ th·ªÉ h·ªßy nh·∫≠n email b·∫•t c·ª© l√∫c n√†o.</p>
    </div>
  </section>
</main>

<!-- FOOTER -->
<footer class="site-footer">
  <div class="container footer-grid" role="contentinfo">
    <div>
      <div class="brand brand--footer" aria-label="TechNoX">TechNoX</div>
      <p class="muted small">ƒêi·ªán tho·∫°i ch√≠nh h√£ng ‚Äî gi√° t·ªët.</p>
    </div>
    <div>
      <h4 class="footer-title">S·∫£n ph·∫©m</h4>
      <ul>
        <li><a href="#">Flagship</a></li>
        <li><a href="#">T·∫ßm trung</a></li>
        <li><a href="#">Ph·ª• ki·ªán</a></li>
      </ul>
    </div>
    <div>
      <h4 class="footer-title">V·ªÅ TechNoX</h4>
      <ul>
        <li><a href="#">Gi·ªõi thi·ªáu</a></li>
        <li><a href="#">C·ª≠a h√†ng</a></li>
        <li><a href="#">Tuy·ªÉn d·ª•ng</a></li>
      </ul>
    </div>
    <div>
      <h4 class="footer-title">H·ªó tr·ª£</h4>
      <ul>
        <li><a href="#">B·∫£o h√†nh</a></li>
        <li><a href="#">Giao h√†ng</a></li>
        <li><a href="#">Li√™n h·ªá</a></li>
      </ul>
    </div>
  </div>

  <div class="container footer-bottom">
    <span class="muted small">¬© TechNoX ‚Äî All rights reserved</span>
    <nav class="footer-links" aria-label="Li√™n k·∫øt ph√°p l√Ω">
      <a href="#">Privacy</a>
      <a href="#">Terms</a>
      <a href="#">Cookies</a>
    </nav>
  </div>
</footer>

<!-- COOKIE BANNER -->
<div class="cookie" *ngIf="cookieOpen" role="dialog" aria-live="polite" aria-label="T√πy ch·ªçn cookie">
  <div class="cookie__panel">
    <h4 class="cookie__title">Cookie preference</h4>
    <p class="cookie__text">Ch√∫ng t√¥i d√πng cookie ƒë·ªÉ c·∫£i thi·ªán tr·∫£i nghi·ªám c·ªßa b·∫°n tr√™n website.</p>
    <div class="cookie__actions">
      <button class="btn" type="button" (click)="acceptCookies()">ƒê·ªíNG √ù</button>
      <button class="btn" type="button" (click)="refuseCookies()">T·ª™ CH·ªêI</button>
      <button class="btn" type="button" (click)="customCookies()">TU·ª≤ CH·ªàNH</button>
    </div>
  </div>
</div>
